<br>
<div class="container">
  <form [formGroup]="sprintReport" (ngSubmit)="onSubmit()" id="form">
    <!-- Intro -->
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-body">
            <div class="card-title">
              <h3 *ngIf="!previous">Sprint Report #{{sprintNumber}}</h3>
              <h3 *ngIf="previous">Sprint Report #{{previousSprintNumber}}</h3>
            </div>
            <!-- Team/Scrum Master Email -->
            <div class="col form-inline">
              <mat-form-field>
                <mat-label>Team</mat-label>
                <mat-select formControlName="team" id="team" >
                  <mat-option value="{{team.team_id}}" *ngFor="let team of teams">{{team.team_id}}</mat-option>
                </mat-select>
              </mat-form-field>
              <p class="mx-3"></p>
              <mat-form-field>
                <mat-label>Scrum Master Email</mat-label>
                <mat-select formControlName="smemail" id="email" >
                  <mat-option value="{{smemail.email}}" *ngFor="let smemail of smemails">{{smemail.email}}</mat-option>
                </mat-select>
              </mat-form-field>
            </div> 
            <!-- Sprint Start End Date -->
            <div class="col form-inline">
              <mat-form-field>
                <mat-label>Choose a date</mat-label>
                <input matInput [matDatepicker]="sprintStart" formControlName="sprintStart" >
                <mat-datepicker-toggle matSuffix [for]="sprintStart"></mat-datepicker-toggle>
                <mat-datepicker #sprintStart></mat-datepicker>
              </mat-form-field>
              <label class="mx-3">To</label>
              <mat-form-field>
                <mat-label>Choose a date</mat-label>
                <input matInput [matDatepicker]="sprintEnd" formControlName="sprintEnd" >
                <mat-datepicker-toggle matSuffix [for]="sprintEnd"></mat-datepicker-toggle>
                <mat-datepicker #sprintEnd></mat-datepicker>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Form Navigation -->
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <div class="left">
              <button mat-button type="button" (click)="fillSprintReport('new')">Newest</button>
              <button mat-button type="button" (click)="fillSprintReport('previous')">Previous</button>
              <button mat-button type="button" (click)="fillSprintReport('next')" [disabled]="!previous">Next</button>
            </div>
            <div class="right">
              <button mat-button>Download</button>
              <button mat-button>Print</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Section 1 -->
    <div class="row">
      <div class="col-md-8">
        <div class="card">
          <div class="card-body">
            <!-- Orginial PBIs -->
            <div class="row">
              <div class="col-md-4 align-self-center">
                <mat-label>Orginally Planned PBIs</mat-label>
              </div>
              <div class="col-md-3">
                <mat-form-field class="completion">
                  <mat-label>Completed</mat-label>
                  <input matInput type="number" class="" formControlName="origPbiComp" >
                </mat-form-field>                
              </div>
              <div class="col-md-3">
                <mat-form-field class="completion">
                  <mat-label>Not Completed</mat-label>
                  <input matInput  type="number" formControlName="origPbiIncomp" >
                </mat-form-field>                
              </div>
              <div class="col-md-2">
                <mat-label>%</mat-label>
                <!-- Can do an ngif to say whether both intial values have a number selected -->
                <p>{{ (origPbiComp!='') ? (((origPbiComp/(origPbiComp+origPbiIncomp))*100).toFixed(2)) : '0.00' }}</p>                
              </div>             
            </div>
            <!-- Orginal Bugs -->
            <div class="row">
              <div class="col-md-4 align-self-center">
                <mat-label>Orginally Planned Bugs</mat-label>
              </div>
              <div class="col-md-3">
                <mat-form-field class="completion">
                  <mat-label>Completed</mat-label>
                  <input matInput type="text" formControlName="origBugComp" >
                </mat-form-field>                
              </div>
              <div class="col-md-3">
                <mat-form-field class="completion">
                  <mat-label>Not Completed</mat-label>
                  <input matInput type="text" formControlName="origBugIncomp" >
                </mat-form-field>                
              </div>
              <div class="col-md-2">
                <mat-label>%</mat-label>
                <p>{{ (origBugComp!='') ? (((origBugComp/(origBugComp+origBugIncomp))*100).toFixed(2)) : '0.00' }}</p>                
              </div>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-body">
            <!-- Additional PBIs -->
            <div class="row">
              <div class="col-md-4 align-self-center">
                <mat-label>Additional PBIs</mat-label>
              </div>
              <div class="col-md-3">
                <mat-form-field class="completion">
                  <mat-label>Completed</mat-label>
                  <input matInput type="text" formControlName="addPbiComp" >
                </mat-form-field>                
              </div>
              <div class="col-md-3">
                <mat-form-field class="completion">
                  <mat-label>Not Completed</mat-label>
                  <input matInput type="text" formControlName="addPbiIncomp" >
                </mat-form-field>                
              </div>
              <div class="col-md-2">
                <mat-label>%</mat-label>
                <p>{{ (addPbiComp!='') ? (((addPbiComp/(addPbiComp+addPbiIncomp))*100).toFixed(2)) : '0.00' }}</p>                
              </div>
            </div>
            <!-- Additional Bugs  -->
            <div class="row">
              <div class="col-md-4 align-self-center">
                <mat-label>Additional Bugs</mat-label>
              </div>
              <div class="col-md-3" >
                <mat-form-field class="completion">
                  <mat-label>Completed</mat-label>
                  <input matInput type="text" formControlName="addBugComp">
                </mat-form-field>                
              </div>
              <div class="col-md-3">
                <mat-form-field class="completion">
                  <mat-label>Not Completed</mat-label>
                  <input matInput type="text" formControlName="addBugIncomp">
                </mat-form-field>                
              </div>
              <div class="col-md-2">
                <mat-label>%</mat-label>
                <p>{{ (addBugComp!='') ? (((addBugComp/(addBugComp+addBugIncomp))*100).toFixed(2)) : '0.00' }}</p>                
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card">
          <div class="card-body ">
            <h4>Reasons For Not Completing</h4>
            <mat-checkbox class="mx-2 my-1 reasons d-flex flex-wrap " *ngFor="let reason of reasons" formControlName="{{reason.code}}">{{reason.reason_desc}}</mat-checkbox>
                <!-- <mat-checkbox class="mx-2 my-1"  name="other">Other
                  <span *ngIf="otherEnabled">
                    <mat-form-field>
                      <input matInput type="text" placeholder="">
                    </mat-form-field>
                  </span>
                </mat-checkbox> -->
          </div>
        </div>
      </div>
    </div> <!--S1 End-->
    <!-- Section 2 -->
    <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="card-body d-flex justify-content-around flex-wrap">
            <div class="col-md-3">
              <h4>Support</h4>
              <mat-form-field class="completion">
                <mat-label>PBIs</mat-label>
                <input matInput type="number" class="" formControlName="supportPbi">
              </mat-form-field> 
              <mat-form-field class="completion">
                <mat-label>Bugs</mat-label>
                <input matInput type="number" class="" formControlName="supportBug">
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <h4>New Value</h4>
              <mat-form-field class="completion">
                <mat-label>PBIs</mat-label>
                <input matInput type="number" class="" formControlName="newValuePbi">
              </mat-form-field>
              <mat-form-field class="completion">
                <mat-label>Bugs</mat-label>
                <input matInput type="number" class="" formControlName="newValueBug">
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <h4>Improvements</h4>
              <mat-form-field class="completion">
                <mat-label>PBIs</mat-label>
                <input matInput type="number" class="" formControlName="improvementsPbi">
              </mat-form-field>
              <mat-form-field class="completion">
                <mat-label>Bugs</mat-label>
                <input matInput type="number" class="" formControlName="improvementsBug">
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>
    </div> <!--S2 End-->
    <!-- Section 3 -->
    <div class="row">
      <div class="col-md-6">
        <div class="card text-center">
          <div class="card-body">
            <div class="card-title">OTRs</div>
            <mat-form-field>
              <mat-select  formControlName="otr" class="completion" multiple>
                <mat-select-trigger>
                  {{otrSelect.value ? otrSelect.value[0] : ''}}
                  <span *ngIf="otrSelect.value?.length > 1" class="plus1Selection">
                    (+{{otrSelect.value.length - 1}} {{otrSelect.value?.length === 2 ? 'other' : 'others'}})
                  </span>
                </mat-select-trigger>
                <mat-option *ngFor="let otr of otrList" [value]="otr.request_id">{{otr.request_id}}</mat-option>
              </mat-select>
            </mat-form-field>
            <p>OTRs Selected:</p> 
            <mat-chip-list class="d-flex justify-content-center">
              <mat-chip *ngFor="let otr of otrSelect.value">{{otr}}</mat-chip>
            </mat-chip-list>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card text-center">
          <div class="card-body">
            <div class="card-title">ITRs</div>
            <mat-form-field>
              <mat-select formControlName="itr" multiple>
                <mat-select-trigger>
                  {{itrSelect.value ? itrSelect.value[0] : ''}}
                  <span *ngIf="itrSelect.value?.length > 1" class="plus1Selection">
                    (+{{itrSelect.value.length - 1}} {{itrSelect.value?.length === 2 ? 'other' : 'others'}})
                  </span>
                </mat-select-trigger>
                <mat-option *ngFor="let itr of itrList" [value]="itr.request_id">{{itr.request_id}}</mat-option>
              </mat-select>
            </mat-form-field>
            <p>ITRs Selected:</p>
            <mat-chip-list class="d-flex justify-content-center">
              <mat-chip *ngFor="let itr of itrSelect.value">{{itr}}</mat-chip>
            </mat-chip-list>
          </div>
        </div>
      </div>
    </div>
    <!-- Section 4 -->
    <div class="row">
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <p>Sprint Capacity</p>
            <div class="d-flex justify-content-center flex-wrap">
              <div class="col-md-4" *ngFor="let cat of sprintCategory">
                <mat-form-field class="completion">
                  <mat-label>{{cat}}</mat-label>
                  <input matInput type="number" class="" formControlName="{{cat|lowercase}}">
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <p>Sprint Hours</p>
            <div class="d-flex justify-content-center flex-wrap">
              <div class="col-md-6" *ngFor="let cat of sprintHours">
                <mat-form-field class="completion">
                  <mat-label>{{cat}}</mat-label>
                  <input matInput type="number" class="" formControlName="{{cat|lowercase}}">
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr>
    <button type="submit" class="btn btn-primary">Save</button>
  </form>
</div>
<br>
<!-- Dyanmic Form -->
<!-- <div *ngFor="let elem of formTemplate">
  <div [ngSwitch]="elem.type">
    <div *ngSwitchCase="'textBox'" class="form-group">
      <label>{{elem.label}}</label>
      <input type="text" formControlName="{{elem.label}}" id="{{elem.label}}" class="form-control">
    </div>
    <div *ngSwitchCase="'number'" class="form-group">
      <label>{{elem.label}}</label>
      <input type="number" formControlName="{{elem.label}}" id="{{elem.label}}" class="form-control">
    </div>
    <div *ngSwitchCase="'select'" class="form-group">
      <label>{{elem.label}}</label>
      <select formControlName="{{elem.label}}" id="{{elem.label}}" class="form-control">
        <option *ngFor="let opt of elem.options">{{opt}}</option>
      </select>
    </div>
  </div>
  </div> -->